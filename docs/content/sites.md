# Sites

Static files can easily be deployed and served from a Wrangler project.

### Setup new project

If you want to setup a new project use  `wrangler generate` . Examples of how to setup a project for Hugo, Gatsby and React can be seen in our [template gallery](TODO).

To set up a generic project you can run:

```
wrangler generate --site myProj
```

This command creates the source directory `dist`, `wrangler.toml`, and `worker-site` directory required. 

Any files you wish to upload and make live should live in `dist`. You can change this later.

### Setup existing static project

If you already have a folder with the static files you'd like to be served from a Worker script, you can upload them to Worker's KV. First run:

```
$ wrangler init --site
```

This command creates the `wrangler.toml` and `worker-site` directory required to upload the files and serve them from our network. 

### Config Bucket

Special keys in your `wrangler.toml` for using sites with Worker scripts are:

| Key             | Value                                                        | Example                              |
| --------------- | ------------------------------------------------------------ | ------------------------------------ |
| `bucket`        | The file path to the static assests you wish to serve in respect to the directory containing your wrangler.toml | `bucket = "./dist"`                  |
| \*`entry-point` | The location of your Worker script, default is `workers-site` which is autogenerated for you | ```entry-point = "./workers-site"``` |

\* Note you shouldn't need to touch these values.

Add this site `bucket to your `wrangler.toml`:

```
name = "my-blog"
type = "webpack"
account_id = "43434f8d0d9f52a395a1472b35f23439" 
site = { bucket = "./public", entry-point = "./workers-site" }
```
Note if using [environments](./environments) make sure to place `site` at the top level config. 

If you used `wrangler init` or `wrangler generate` with the `â€”site` flag, then the `entry-point` will be set to default.

##### Deploy Config

Setup the `account_id`, `zone_id`, `route`, and `workers_dev` you wish to  publish following [the project config steps](../../#-config).

### Deploy

Now that you have configured your project to use the static files, time to upload them and deploy the Worker. This can be done from `wrangler publish`:

```console
$ wrangler publish
=> Writing contents of ./public to bucket c417513a199c4289a1a0c8385c58a0e7
=> Publishing workers-sites
=> Success! Your site is live at myblog.examples.workers.dev
```

#### Advanced: Modifying the Worker 

If you used `wrangler init` or `wrangler generate` with the `--site` flag, then your Worker should already live in `worker-site/index.js`. If not, you'll want to configure a Worker script to serve the files from KV:

Configureing the Worker script to do something custom like strip `/docs` looks like:

```javascript
import { getAssetFromKV } from '@cloudflare/kv-asset-handlers'

addEventListener('fetch', event => {
  event.respondWith(handleRequest(event))
})
// Map how the path of an incoming request will map to a file path
// from your bucket
function keyModifier(path) {
  if (path.endsWith('/')) {
    path += `index.html`
  }
	return path.replace('/docs', '')
}
async function handleRequest(request) {
  try {
    return await getAssetFromKV(event, {
      cacheControl: { bypassCache: true },
      keyModifier: keyModifier,
    })
  } catch (e) {
    return new Response(`"${url.pathname}" not found`, {
      status: 404,
      statusText: 'not found',
    })
  }
}
```

More information on the configurable options of `getAssetFromKV` see [@cloudflare/kv-asset-handler](TODO).



